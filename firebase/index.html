<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="theme-color" content="#fdfbf7" />
  <title>å‹˜å®šç§‘ç›®åˆ†é¡ã‚²ãƒ¼ãƒ </title>
  <link rel="stylesheet" href="styles.css" />
  <link rel="icon" href="icons/app-icon.svg" type="image/svg+xml">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@400;700;800&display=swap"
    rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
  <main class="app">
    <header>
      <h1>å‹˜å®šç§‘ç›®åˆ†é¡ã‚²ãƒ¼ãƒ </h1>
    </header>

    <section class="control-panel">
      <div class="panel-inner">
        <form id="grade-form">
          <label for="exam-select">è©¦é¨“</label>
          <select id="exam-select" required>
            <option value="æ—¥å•†" selected>æ—¥å•†</option>
          </select>
          <label for="grade-select">ç´š</label>
          <select id="grade-select" required>
            <option value="3ç´š" selected>3ç´š</option>
            <option value="2ç´š">2ç´š</option>
          </select>
          <label class="yomi-toggle"><input type="checkbox" id="show-yomi"> ã‚ˆã¿è¡¨ç¤º</label>
        </form>
        <div class="start-buttons">
          <button type="button" class="start-button push-btn" data-count="10" disabled>10å•</button>
          <button type="button" class="start-button push-btn" data-count="20" disabled>20å•</button>
          <button type="button" class="start-button push-btn" data-count="30" disabled>30å•</button>
        </div>
      </div>
      <div class="sub-controls">
        <button id="show-stats-button" type="button" class="sm-btn">ğŸ“Š ãƒ‡ãƒ¼ã‚¿</button>
        <button id="export-button" type="button" class="sm-btn" disabled>ãƒ­ã‚°ä¿å­˜</button>
      </div>
      <div id="csv-fallback" class="csv-fallback" hidden>
        <p class="fallback-msg">è‡ªå‹•èª­ã¿è¾¼ã¿ã§ãã¾ã›ã‚“ã§ã—ãŸ<br><small>(ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„)</small></p>
        <button id="local-csv-button" type="button" class="ghost-button">CSVã‚’é¸æŠ</button>
        <input type="file" id="local-csv-input" accept=".csv,text/csv" hidden />
      </div>
    </section>

    <div class="game-board-wrapper">
      <section class="status-bar">
        <div class="status-item">æ®‹ã‚Š <span id="question-count">0</span>/<span id="question-target">0</span></div>
        <div class="status-item timer">â° <span id="timer-display">00:00</span></div>
        <div class="status-item score">æ­£è§£ <span id="correct-count">0</span></div>
      </section>

      <div id="feedback" class="feedback-toast">ã‚¹ã‚¿ãƒ¼ãƒˆãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ã­ï¼</div>

      <section class="board">
        <div class="card-area">
          <div id="account-card" class="account-card pop-in">
            <div id="account-yomi" class="account-yomi"></div>
            <div id="account-card-text">---</div>
          </div>
          <button id="skip-button" type="button" class="skip-btn" disabled>ãƒ‘ã‚¹</button>
        </div>

        <div class="t-forms-container">

          <div class="t-account bs-account">
            <div class="t-header">
              <span class="side-label">å€Ÿæ–¹</span>
              <h2>è²¸å€Ÿå¯¾ç…§è¡¨ (B/S)</h2>
              <span class="side-label">è²¸æ–¹</span>
            </div>
            <div class="t-body">
              <div class="t-col t-left">
                <div class="drop-zone type-asset push-btn" data-type="asset" tabindex="0">
                  <h3>è³‡ç”£</h3>
                </div>
              </div>
              <div class="t-divider"></div>
              <div class="t-col t-right">
                <div class="drop-zone type-liability push-btn" data-type="liability" tabindex="0">
                  <h3>è² å‚µ</h3>
                </div>
                <div class="drop-zone type-equity push-btn" data-type="equity" tabindex="0">
                  <h3>ç´”è³‡ç”£</h3>
                </div>
              </div>
            </div>
          </div>

          <div class="t-account pl-account">
            <div class="t-header">
              <span class="side-label">å€Ÿæ–¹</span>
              <h2>æç›Šè¨ˆç®—æ›¸ (P/L)</h2>
              <span class="side-label">è²¸æ–¹</span>
            </div>
            <div class="t-body">
              <div class="t-col t-left">
                <div class="drop-zone type-expense push-btn" data-type="expense" tabindex="0">
                  <h3>è²»ç”¨</h3>
                </div>
              </div>
              <div class="t-divider"></div>
              <div class="t-col t-right">
                <div class="drop-zone type-revenue push-btn" data-type="revenue" tabindex="0">
                  <h3>åç›Š</h3>
                </div>
              </div>
            </div>
          </div>

          <div class="other-zone-wrapper">
            <div class="drop-zone type-other push-btn" data-type="other" tabindex="0">
              <h3>ãã®ä»–</h3>
            </div>
          </div>

        </div>
      </section>
    </div>

    <section class="history">
      <h2>ğŸ“œ å›ç­”å±¥æ­´</h2>
      <ul id="history-list"></ul>
    </section>
  </main>

  <template id="history-item-template">
    <li class="pop-in-sm">
      <span class="history-account"></span>
      <span class="history-result"></span>
    </li>
  </template>

  <div id="countdown-overlay" class="countdown-overlay" hidden>
    <div class="countdown-number">3</div>
  </div>

  <div id="result-overlay" class="result-overlay" hidden>
    <div class="result-card">
      <h2>ğŸ‰ FINISH!</h2>
      <p id="result-message">---</p>
      <div class="score-box">
        <p id="result-score" class="big-score">---</p>
      </div>
      <p id="result-time">---</p>
      <p id="result-breakdown" class="breakdown">---</p>
      <p id="result-speed-comment" class="speed-comment"></p>
      <p id="result-time-bonus" class="speed-comment"></p>

      <!-- é–“é•ãˆãŸå•é¡Œãƒªã‚¹ãƒˆ -->
      <div id="wrong-answers-section" class="wrong-answers-section" hidden>
        <h3>âš ï¸ é–“é•ãˆãŸå•é¡Œ</h3>
        <ul id="wrong-answers-list" class="wrong-list"></ul>
      </div>

      <div class="result-actions">
        <button type="button" id="result-close" class="ghost-button">é–‰ã˜ã‚‹</button>
        <button type="button" id="result-retry" class="primary-button push-btn">ã‚‚ã†ä¸€åº¦ï¼</button>
      </div>
    </div>
  </div>

  <!-- çµ±è¨ˆãƒ»ãƒ‡ãƒ¼ã‚¿ç”»é¢ -->
  <div id="stats-overlay" class="result-overlay" hidden>
    <div class="result-card stats-card">
      <div class="stats-header">
        <h2>ğŸ“Š ãƒ—ãƒ¬ã‚¤ãƒ‡ãƒ¼ã‚¿</h2>
        <button type="button" id="stats-close" class="ghost-button">é–‰ã˜ã‚‹</button>
      </div>

      <div class="stats-content">
        <div class="chart-filter">
          <label for="question-filter">å‡ºé¡Œæ•°</label>
          <select id="question-filter">
            <option value="all">å…¨ã¦</option>
            <option value="10">10å•</option>
            <option value="20">20å•</option>
            <option value="30">30å•</option>
          </select>
        </div>

        <div class="stats-meta">
          <div class="stats-col stats-mini">
            <h3 id="mission-title">ğŸ¯ ä»Šæ—¥ã®ãƒŸãƒƒã‚·ãƒ§ãƒ³</h3>
            <p id="mission-text" class="mission-text">èª­ã¿è¾¼ã¿ä¸­...</p>
          </div>
          <div class="stats-col stats-mini">
            <h3 id="achievement-title">ğŸ… ç§°å·</h3>
            <ul id="achievement-list" class="ranking-list achievement-list"></ul>
          </div>
          <div class="stats-col stats-mini stats-calendar">
            <h3 id="calendar-title">ğŸ“… ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚¯ãƒªã‚¢</h3>
            <div class="calendar-header">
              <button type="button" id="calendar-prev" class="ghost-button calendar-nav">â—€</button>
              <span id="calendar-month"></span>
              <button type="button" id="calendar-next" class="ghost-button calendar-nav">â–¶</button>
            </div>
            <div id="mission-calendar" class="calendar-grid"></div>
          </div>
        </div>

        <div class="charts-wrapper">
          <div class="chart-container">
            <h3 id="accuracy-title">ğŸ“ˆ æ­£ç­”ç‡æ¨ç§» (%)</h3>
            <canvas id="accuracy-chart"></canvas>
          </div>
          <div class="chart-container">
            <h3 id="time-title">â±ï¸ è§£ç­”æ™‚é–“æ¨ç§» (ç§’)</h3>
            <canvas id="time-chart"></canvas>
          </div>
        </div>

        <div class="stats-lists">
          <div class="stats-col">
            <h3 id="best-title">ğŸ† å¾—æ„ãªç§‘ç›® (Best 5)</h3>
            <ul id="best-list" class="ranking-list"></ul>
          </div>
          <div class="stats-col">
            <h3 id="worst-title">ğŸ˜± è‹¦æ‰‹ãªç§‘ç›® (Worst 5)</h3>
            <ul id="worst-list" class="ranking-list"></ul>
          </div>
        </div>

        <div class="stats-col stats-dictionary">
          <h3 id="dictionary-title">ğŸ“š å‹˜å®šç§‘ç›®è¾æ›¸</h3>
          <ul id="dictionary-list" class="ranking-list dictionary-list"></ul>
        </div>

        <div class="stats-actions">
          <button type="button" id="clear-data-button" class="ghost-button danger-text">ãƒ‡ãƒ¼ã‚¿ã‚’æ¶ˆå»ã™ã‚‹</button>
        </div>
      </div>
    </div>
  </div>

  <!-- ãƒ‡ãƒ¼ã‚¿æ¶ˆå»ç¢ºèªãƒ¢ãƒ¼ãƒ€ãƒ« -->
  <div id="confirm-overlay" class="result-overlay" hidden>
    <div class="result-card confirm-card">
      <h2>âš ï¸ ç¢ºèª</h2>
      <p>ã“ã‚Œã¾ã§ã®æˆç¸¾ã¨å¾©ç¿’ãƒ‡ãƒ¼ã‚¿ã‚’<br>ã™ã¹ã¦æ¶ˆå»ã—ã¾ã™ã‹ï¼Ÿ</p>
      <p class="confirm-note">â€»ã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“</p>
      <div class="result-actions">
        <button type="button" id="confirm-cancel" class="ghost-button">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
        <button type="button" id="confirm-ok" class="primary-button push-btn danger-btn">æ¶ˆå»</button>
      </div>
    </div>
  </div>

  <script src="script.js"></script>

  <footer class="app-footer">Â© Daisuke NAKAMURA</footer>

  <script type="module">
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
    // Firestore
    import { getFirestore } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-firestore.js";
    // TODO: Add SDKs for Firebase products that you want to use
    // https://firebase.google.com/docs/web/setup#available-libraries

    // Your web app's Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyAGPO78QvkLDt3FvjhpSqV6OYRm--DMzGg",
      authDomain: "ac-game-prod.firebaseapp.com",
      projectId: "ac-game-prod",
      storageBucket: "ac-game-prod.firebasestorage.app",
      messagingSenderId: "101943470104",
      appId: "1:101943470104:web:ed5d08b13f9298b7e27b6d"
    };

    // FirebaseåˆæœŸåŒ–
    const app = initializeApp(firebaseConfig);
    // FirestoreåˆæœŸåŒ–
    const db = getFirestore(app);

    // æ—¢å­˜ã®script.jsã‹ã‚‰ä½¿ãˆã‚‹ã‚ˆã†ã«ã‚°ãƒ­ãƒ¼ãƒãƒ«ã¸å‡ºã—ã¦ãŠã
    window.firebaseApp = app;
    window.db = db;
  </script>

</body>

</html>